!function(t){"use strict";t([],function(){var t=/^([\w-]+)(?:\.([\w-]+)(?:\(([^\)]*)\))?)?::([^$]*)/,e=function(e){this.__c3po__=!0,this.original=e;if("<"!==e[0]){var i=t.exec(e);i&&(this.protocol=i[1],this.method=i[2]||"get",this.args=i[3]?i[3].split(",").map(function(t){return t.trim()}):null,this.pointer=i[4],this.interpolable=n.interpolator?n.interpolator.isInterpolable(this.pointer):!1)}};e.prototype={exec:function(t,e){if(!this.protocol)return this.original;t=t||t;var i=n.protocol(this.protocol),o=this.interpolable&&n.interpolator&&e?n.interpolator.interpolate(this.pointer,e):this.pointer,r=this.method,l=this.args?[].concat(this.args,o,t):[o,t];return i&&"function"==typeof i.then?i.then(function(t){return t[r].apply(t,l)}):i[r].apply(i,l)}};var n={Request:e,requestCache:{},protocols:{dummy:{get:function(t){return{dummy:t}}}},fromContext:null,interpolator:null,protocol:function(t){var e=null;if("string"==typeof t){if(n.fromContext&&(e=n.fromContext(t)),e||(e=n.protocols[t]),!e)throw new Error("no protocol found with : ",t)}else e=t;if(e._deep_flattener_&&!e._deep_flattened_)return(e._deep_flattening_?e._deep_flattening_:e.flatten()).then(function(){return n.protocol(e)});if(e._deep_ocm_&&(e=e()),e.init&&!e.initialised){var i;if(i=e.initialising?e.initialising:e.init(),i&&"function"==typeof i.then)return e.initialising=i,i.then(function(){return e.initialising=null,e.initialised=!0,e});e.initialised=!0}return e},get:function(t,e,i){return t.__c3po__||(n.requestCache&&n.requestCache[t]?t=n.requestCache[t]:(t=new n.Request(t),n.requestCache&&(n.requestCache[t.original]=t))),t.exec(e,i)},getAll:function(t,e,i){return t.map(function(t){return n.get(t,e,i)})}};return n})}("undefined"!=typeof define?define:function(t,e){"undefined"!=typeof module?module.exports=e():"undefined"!=typeof window?window.c3po=e(null):console.warn("c3po has not been mounted somewhere.")});